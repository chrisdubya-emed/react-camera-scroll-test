"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("postprocessing"),t=require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),r=require("react"),n=require("three"),o=require("@babel/runtime/helpers/extends"),i=require("@babel/runtime/helpers/construct"),u=require("@react-three/fiber");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var c=a(t),f=a(r),l=a(o),s=a(i),d=function(t,n){return void 0===n&&(n=e.BlendFunction.NORMAL),r.forwardRef((function(e,o){var i=e.blendFunction,u=e.opacity,a=c.default(e,["blendFunction","opacity"]),l=r.useMemo((function(){return new t(a)}),[a]);return r.useLayoutEffect((function(){l.blendMode.blendFunction=i||n,void 0!==u&&(l.blendMode.opacity.value=u)}),[i,l.blendMode,u]),f.default.createElement("primitive",{ref:o,object:l,dispose:null})}))},p=function(e,t){var o=e[t];return r.useMemo((function(){if(o instanceof n.Vector2)return(new n.Vector2).set(o.x,o.y);if(Array.isArray(o)){var e=o[0],t=o[1];return(new n.Vector2).set(e,t)}}),[o])},m=function(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(e){return!1}},v=d(e.BloomEffect,e.BlendFunction.SCREEN),h=d(e.BrightnessContrastEffect),E=r.forwardRef((function(t,n){var o=p(t,"offset"),i=r.useMemo((function(){return new e.ChromaticAberrationEffect(l.default({},t,{offset:o}))}),[o,t]);return f.default.createElement("primitive",{ref:n,object:i,dispose:null})})),x=r.forwardRef((function(t,n){var o=t.blendFunction,i=void 0===o?e.BlendFunction.NORMAL:o,u=r.useMemo((function(){return new e.ColorAverageEffect(i)}),[i]);return f.default.createElement("primitive",{ref:n,object:u,dispose:null})})),g=d(e.ColorDepthEffect),b=d(e.DepthEffect),S=r.createContext(null),w=f.default.memo(r.forwardRef((function(t,n){var o=t.children,i=t.camera,a=t.scene,c=t.renderPriority,l=void 0===c?1:c,d=t.autoClear,p=void 0===d||d,v=t.depthBuffer,h=t.disableNormalPass,E=t.stencilBuffer,x=t.multisampling,g=void 0===x?8:x,b=t.frameBufferType,w=u.useThree(),y=w.gl,C=w.scene,M=w.camera,R=w.size;a=a||C,i=i||M;var A=r.useMemo((function(){var t=new e.EffectComposer(y,{depthBuffer:v,stencilBuffer:E,multisampling:m()?g:0,frameBufferType:b});t.addPass(new e.RenderPass(a,i));var r=h?null:new e.NormalPass(a,i);return r&&t.addPass(r),[t,r]}),[i,y,v,E,g,b,a,h]),L=A[0],B=A[1];r.useEffect((function(){return null==L?void 0:L.setSize(R.width,R.height)}),[L,R]),u.useFrame((function(e,t){return y.autoClear=p,void L.render(t)}),l);var T=r.useRef(null);r.useEffect((function(){var t;return T.current&&T.current.__r3f&&L&&(t=s.default(e.EffectPass,[i].concat(T.current.__r3f.objects)),L.addPass(t),t.renderToScreen=!0),function(){t&&(null==L||L.removePass(t))}}),[L,o,i]);var F=r.useMemo((function(){return{composer:L,normalPass:B,camera:i,scene:a}}),[L,B,i,a]);return r.useImperativeHandle(n,(function(){return L}),[L]),f.default.createElement(S.Provider,{value:F},f.default.createElement("group",{ref:T},o))}))),y=r.forwardRef((function(t,o){var i=t.target,u=t.depthTexture,a=c.default(t,["target","depthTexture"]),l=r.useContext(S).camera,s=r.useMemo((function(){return new e.DepthOfFieldEffect(l,a)}),[l,a]);return r.useLayoutEffect((function(){if(i){var e=i instanceof n.Vector3?(new n.Vector3).set(i.x,i.y,i.z):(new n.Vector3).set(i[0],i[1],i[2]);s.target=e}u&&s.setDepthTexture(u.texture,u.packing)}),[i,u,s]),f.default.createElement("primitive",{ref:o,object:s,dispose:null})})),C=d(e.DotScreenEffect),M=r.forwardRef((function(t,n){var o=t.active,i=void 0===o||o,u=c.default(t,["active"]),a=p(u,"delay"),s=p(u,"duration"),d=p(u,"strength"),m=r.useMemo((function(){return new e.GlitchEffect(l.default({},u,{delay:a,duration:s,strength:d}))}),[a,s,u,d]);return r.useLayoutEffect((function(){m.mode=i?u.mode||e.GlitchMode.SPORADIC:e.GlitchMode.DISABLED}),[i,m,u.mode]),f.default.createElement("primitive",{ref:n,object:m,dispose:null})})),R=r.forwardRef((function(t,n){var o=r.useContext(S).camera,i=r.useMemo((function(){return new e.GodRaysEffect(o,t.sun,t)}),[o,t]);return f.default.createElement("primitive",{ref:n,object:i,dispose:null})})),A=r.forwardRef((function(t,n){var o=t.size,i=c.default(t,["size"]),u=r.useMemo((function(){return new e.GridEffect(i)}),[i]);return r.useLayoutEffect((function(){o&&u.setSize(o.width,o.height)}),[u,o]),f.default.createElement("primitive",{ref:n,object:u,dispose:null})})),L=d(e.HueSaturationEffect),B=d(e.NoiseEffect,e.BlendFunction.COLOR_DODGE),T=r.forwardRef((function(t,n){var o=t.selection,i=void 0===o?[]:o,u=t.selectionLayer,a=void 0===u?10:u,l=t.blendFunction,s=t.patternTexture,d=t.edgeStrength,p=t.pulseSpeed,m=t.visibleEdgeColor,v=t.hiddenEdgeColor,h=t.width,E=t.height,x=t.kernelSize,g=t.blur,b=t.xRay;c.default(t,["selection","selectionLayer","blendFunction","patternTexture","edgeStrength","pulseSpeed","visibleEdgeColor","hiddenEdgeColor","width","height","kernelSize","blur","xRay"]);var w=r.useContext(S),y=w.scene,C=w.camera,M=r.useMemo((function(){return new e.OutlineEffect(y,C,{blendFunction:l,patternTexture:s,edgeStrength:d,pulseSpeed:p,visibleEdgeColor:m,hiddenEdgeColor:v,width:h,height:E,kernelSize:x,blur:g,xRay:b})}),[l,g,C,d,E,v,x,s,p,y,m,h,b]);return r.useEffect((function(){M.clearSelection(),M.setSelection(Array.isArray(i)?i.map((function(e){return e.current})):[i.current])}),[M,i]),r.useEffect((function(){M.selectionLayer=a}),[M,a]),f.default.createElement("primitive",{ref:n,object:M,dispose:null})})),F=r.forwardRef((function(t,n){var o=t.granularity,i=void 0===o?5:o,u=r.useMemo((function(){return new e.PixelationEffect(i)}),[i]);return f.default.createElement("primitive",{ref:n,object:u,dispose:null})})),P=d(e.ScanlineEffect,e.BlendFunction.OVERLAY),j=r.forwardRef((function(t,n){var o=t.selection,i=void 0===o?[]:o,u=t.selectionLayer,a=void 0===u?10:u,c=t.lights,l=void 0===c?[]:c,s=t.luminanceThreshold,d=t.luminanceSmoothing,p=t.intensity,m=t.width,v=t.height,h=t.kernelSize;0===l.length&&console.warn("SelectiveBloom requires lights to work.");var E=r.useContext(S),x=E.scene,g=E.camera,b=r.useMemo((function(){return new e.SelectiveBloomEffect(x,g,{blendFunction:e.BlendFunction.SCREEN,luminanceThreshold:s,luminanceSmoothing:d,intensity:p,width:m,height:v,kernelSize:h})}),[g,v,p,h,d,s,x,m]);return r.useEffect((function(){b.selection.set(Array.isArray(i)?i.map((function(e){return e.current})):[i.current])}),[b,i]),r.useEffect((function(){b.selection.layer=a}),[b,a]),r.useEffect((function(){return l.forEach((function(e){return function(e,t){e.current&&e.current.layers.enable(t.selection.layer)}(e,b)})),function(){return l.forEach((function(e){return function(e,t){e.current&&e.current.layers.disable(t.selection.layer)}(e,b)}))}}),[b,l,a]),f.default.createElement("primitive",{ref:n,object:b,dispose:null})})),O=d(e.SepiaEffect),D=r.forwardRef((function(t,n){var o=r.useContext(S),i=o.camera,u=o.normalPass,a=r.useMemo((function(){return null===u?(console.error("Please enable the NormalPass in the EffectComposer in order to use SSAO."),null):new e.SSAOEffect(i,u.renderTarget.texture,l.default({blendFunction:e.BlendFunction.MULTIPLY,samples:30,rings:4,distanceThreshold:1,distanceFalloff:0,rangeThreshold:.5,rangeFalloff:.1,luminanceInfluence:.9,radius:20,scale:.5,bias:.5},t))}),[i,u,t]);return f.default.createElement("primitive",{ref:n,object:a,dispose:null})})),G=r.forwardRef((function(t,n){var o=t.preset,i=void 0===o?e.SMAAPreset.HIGH:o,a=t.edgeDetectionMode,c=void 0===a?e.EdgeDetectionMode.COLOR:a,l=u.useLoader(e.SMAAImageLoader,""),d=r.useMemo((function(){return s.default(e.SMAAEffect,l.concat([i,c]))}),[l,i,c]);return f.default.createElement("primitive",{ref:n,object:d,dispose:null})})),z=r.forwardRef((function(t,o){var i=t.textureSrc,a=t.texture,s=c.default(t,["textureSrc","texture"]),d=u.useLoader(n.TextureLoader,i);r.useLayoutEffect((function(){d.encoding=n.sRGBEncoding,d.wrapS=d.wrapT=n.RepeatWrapping}),[d]);var p=r.useMemo((function(){return new e.TextureEffect(l.default({},s,{texture:d||a}))}),[s,d,a]);return f.default.createElement("primitive",{ref:o,object:p,dispose:null})})),k=d(e.ToneMappingEffect),N=d(e.VignetteEffect),V=d(e.ShockWaveEffect);exports.Bloom=v,exports.BrightnessContrast=h,exports.ChromaticAberration=E,exports.ColorAverage=x,exports.ColorDepth=g,exports.Depth=b,exports.DepthOfField=y,exports.DotScreen=C,exports.EffectComposer=w,exports.EffectComposerContext=S,exports.Glitch=M,exports.GodRays=R,exports.Grid=A,exports.HueSaturation=L,exports.Noise=B,exports.Outline=T,exports.Pixelation=F,exports.SMAA=G,exports.SSAO=D,exports.Scanline=P,exports.SelectiveBloom=j,exports.Sepia=O,exports.ShockWave=V,exports.Texture=z,exports.ToneMapping=k,exports.Vignette=N;
